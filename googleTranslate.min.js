window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),o=n.length>>>0;if(0==o)return!1;var i,s,e=0|e,a=Math.max(0<=e?e:o-Math.abs(e),0);for(;a<o;){if((i=n[a])===(s=t)||"number"==typeof i&&"number"==typeof s&&isNaN(i)&&isNaN(s))return!0;a++}return!1}});var googleTranslate={apiProxy:"",translationNode:document.body,observeMutationsOn:[],nodeListSourceLanguage:[],nodeListTextLanguage:[],excludeElements:[],mutatationIds:[],sourceLanguage:"",targetLanguage:"",nodeList:[],nodeTextList:[],mutationNodeList:[],mutationTextList:[],traverseTextNodes:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.nodeList,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.nodeTextList;t.childNodes.forEach(function(t){this.excludeElements.includes(t)||"SCRIPT"===t.tagName||(3===t.nodeType&&""!==t.nodeValue.trim()?(e.push(t),n.push(t.nodeValue.trim())):this.traverseTextNodes(t,e,n))}.bind(this))},translate:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.nodeList,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.nodeTextList,i=new XMLHttpRequest;return i.open("POST",this.apiProxy,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),new Promise(function(e,t){i.onload=function(){var t;200<=this.status&&this.status<400?(t=JSON.parse(this.response)).error?(console.log(t.error),e(!1)):(t.translations.forEach(function(t,e){n[e].nodeValue=t.translatedText}),e(!0)):(console.error("API Error: "+this.status),e(!1))},i.onerror=function(){console.error("Could not connect to API.")},i.send(JSON.stringify({sourceLanguageCode:this.sourceLanguage,targetLanguageCode:this.targetLanguage,mimeType:"text/plain",contents:o}))}.bind(this))},mutationListener:function(t){var e=function(t,e){var n=!0,o=!1,i=void 0;try{for(var s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var a=a.value;"childList"===a.type&&(a=document.getElementById(a.target.id),this.mutationNodeList=[],this.mutationTextListList=[],this.traverseTextNodes(a,this.mutationNodeList,this.mutationTextListList),this.translate(this.mutationNodeList,this.mutationTextListList))}}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}}.bind(this);new MutationObserver(e).observe(t,{childList:!0,subtree:!0})},setTargetLanguage:function(t){return localStorage.setItem("gTranslate_lang",t),t===this.sourceLanguage||0<this.mutationNodeList.length?(location.reload(),new Promise(function(t,e){t(!0)})):(this.targetLanguage=t,this.translate())},init:function(t){this.apiProxy=t.apiProxy,this.sourceLanguage=t.sourceLanguage,void 0!==t.node&&(this.translationNode=document.body),void 0!==t.excludeElements&&(this.excludeElements=t.excludeElements),this.traverseTextNodes(this.translationNode);t=localStorage.getItem("gTranslate_lang");return null!==t&&t!==this.sourceLanguage?this.setTargetLanguage(t):new Promise(function(t,e){t(!0)})}};
